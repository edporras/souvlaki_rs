#!/bin/bash

if [[ $# -ne 2 ]]; then
    echo "Usage: libretime_import API_KEY AUDIO_FILE"
    exit 1
fi

API_KEY=$1
FILE=$2

if [[ ! -f "$FILE" ]]; then
    echo "File not found"
    exit 1
fi

resp=`curl -fL -X POST \
           'http://localhost:2201/rest/media' \
           -u "$API_KEY": \
           -F "file=@$FILE" \
           --max-time 30 \
      | jq .import_status`

if [[ "$resp" != "1" ]]; then
    echo "error importing file"
    exit 1
fi
